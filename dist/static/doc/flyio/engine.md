# Http Engine

Flyå¼•å…¥äº†Http engineçš„æ¦‚å¿µï¼Œæ‰€è°“Http engineï¼Œå°±æ˜¯çœŸæ­£å‘èµ·httpè¯·æ±‚çš„å¼•æ“ï¼Œè¿™åœ¨æµè§ˆå™¨ä¸­å°±æ˜¯XMLHttpRequestæˆ–ActiveXObject (IE)ï¼Œè€Œåœ¨nodeç¯å¢ƒä¸­ï¼Œengineå¯ä»¥ç”¨ä»»ä½•èƒ½å‘èµ·ç½‘ç»œè¯·æ±‚çš„åº“ï¼æ¨¡å—å®ç°ã€‚ Flyæ­£æ˜¯é€šè¿‡åœ¨ä¸åŒçš„ç¯å¢ƒæ›´æ¢ä¸åŒçš„engineè€Œå®ç°åŒæ—¶æ”¯æŒnodeå’Œbrowserã€‚

**åˆ‡æ¢engine**:

```javascript
var  fly=require("flyio")
//æµè§ˆå™¨ç¯å¢ƒä¸‹
fly.engine=XMLHttpRequest
//nodeç¯å¢ƒ
fly.engine=xx  //ä»»ä½•å®ç°äº†engineæ¥å£çš„å¯¹è±¡
```

ä¸Šé¢ä»£ç ç¤ºæ„äº†flyå¦‚ä½•åˆ‡æ¢engineï¼Œé‚£ä¹ˆå¦‚ä½•æ¥æä¾›è‡ªå®šä¹‰çš„engine, æœ¬è´¨ä¸Šæ¥è®²ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå’ŒXMLHttpRequestæœ‰ç›¸åŒæ¥å£ã€å±æ€§ã€è¡Œä¸ºçš„å¯¹è±¡ã€‚è¿™å¾ˆç³Ÿç³•ï¼Œå› ä¸ºè¿™å¿…é¡»å¾—äº†è§£XMLHttpRequestçš„å„ä¸ªç»†èŠ‚ï¼Œä¸ºäº†ç®€åŒ–engineçš„å®ç°ï¼ŒFlyæä¾›äº†ä¸€ä¸ªengine-wrapperæ¨¡å—ï¼Œå®ƒæ˜¯ä¸€ä¸ªengineçš„éª¨æ¶ï¼Œå¼€å‘è€…åªéœ€è¦å®ç°ä¸€ä¸ªé€‚é…å™¨ï¼ˆadapterï¼‰ä¾¿å¯æ–¹ä¾¿çš„ç”Ÿæˆä¸€ä¸ªengineã€‚ä¸‹é¢æˆ‘ä»¬çœ‹çœ‹Flyå†…ç½®çš„node engineçš„å¤§æ¦‚å®ç°ï¼š

```javascript
var  Fly=require("../dist/fly")
var EngineWrapper = require("../dist/engine-wrapper")
//å¼•å…¥flyå®ç°çš„node adapter
var adapter = require("./adapter/node")
//é€šè¿‡åŒ…è£…node adapterç”Ÿæˆä¸€ä¸ªengine
var engine=EngineWrapper(adapter)
module.exports=new Fly(engine)
```

**engine.setAdapter (adpter)**

æ¯ä¸ªengineå¯ä»¥éšæ—¶åˆ‡æ¢adpterå¯å®ç°å’Œåˆ‡æ¢httpå¼•æ“ç›¸åŒçš„ç›®çš„ã€‚ç°åœ¨é—®é¢˜å˜å¾—å¾ˆç®€å•ï¼Œå°±æ˜¯å¦‚ä½•å®ç°adapter.

## Adapter

é€šè¿‡ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼ŒçœŸæ­£çš„httpè¯·æ±‚åŠ¨ä½œæ˜¯åœ¨adapterä¸­å®Œæˆçš„ã€‚adapteræ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ¥å£ï¼Œç­¾åå¦‚ä¸‹

```javascript
function (request, responseCallBack)
```

**request**: httpè¯·æ±‚ä¿¡æ¯ï¼Œç”±engine ä¼ ç»™adapterï¼Œ**åŸºæœ¬ç»“æ„å­—æ®µ**å¦‚ä¸‹ï¼š

```javascript
{
  method:"",//è¯·æ±‚æ–¹æ³•ï¼Œ GET ã€POST ...
  headers:{},//è¯·æ±‚å¤´
  url:"",//è¯·æ±‚åœ°å€
  timeout:"",//è¶…æ—¶æ—¶é—´
  data:""//è¯·æ±‚æ•°æ®ï¼ŒGETè¯·æ±‚æ—¶ä¸ºnull
}
```

**responseCallBack(response)**: å“åº”å›è°ƒ

è¯·æ±‚ç»“æŸæ—¶adapteråº”è°ƒç”¨æ­¤å‡½æ•°ï¼Œé€šçŸ¥engineè¯·æ±‚ç»“æŸ, response**åŸºæœ¬ç»“æ„å­—æ®µ**å¦‚ä¸‹ï¼š

```javascript
{
    responseText: '{"aa":5}',//å“åº”å†…å®¹ï¼Œä¸ºå­—ç¬¦ä¸²
    statusCode: 200,// http çŠ¶æ€ç ï¼Œå‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå€¼ä¸º0
    errMsg:"", //é”™è¯¯ä¿¡æ¯ï¼Œ
    headers: {}//å“åº”å¤´
}
```

æ•´ä¸ªè¯·æ±‚è¿‡ç¨‹ä¸ºï¼šæ¯æ¬¡è¯·æ±‚å¼€å§‹çš„æ—¶å€™ï¼Œflyå°†ç”¨æˆ·æœ¬æ¬¡çš„è¯·æ±‚ä¿¡æ¯ä¼ ç»™http engineï¼Œç„¶åhttp engineæ ¹æ®ç”¨æˆ·è¯·æ±‚ä¿¡æ¯ç”Ÿæˆä¸€ä¸ªrequestå¯¹è±¡ä¼ é€’ç»™adapterï¼Œ æ¥ç€adapterå‘èµ·çœŸæ­£çš„httpè¯·æ±‚ï¼Œç­‰åˆ°è¯·æ±‚ç»“æŸæ—¶ï¼Œadapteré€šè¿‡è°ƒç”¨responseCallBackå°†è¯·æ±‚ç»“æœè¿”å›ç»™http engine.  ç„¶åhttp engineå°†ç»“æœè¿”å›ç»™flyã€‚

**åŸºæœ¬ç»“æ„å­—æ®µï¼š**

æ‰€è°“åŸºæœ¬ç»“æ„å­—æ®µæ˜¯flyå®šä¹‰çš„æ ‡å‡†å­—æ®µã€‚é™¤äº†è¿™äº›åŸºæœ¬ç»“æ„å­—æ®µï¼Œå¯ä»¥ä»»æ„æ‰©å±•ï¼š

å¯¹äºrequestå¯¹è±¡ï¼Œ ç”¨æˆ·åœ¨å‘èµ·çš„è¯·æ±‚é…ç½®optionsä¸­çš„å…¶å®ƒå­—æ®µä¹Ÿä¼šmergeåˆ°requestå¯¹è±¡ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨adapterÂ ä¸­è·å–åˆ°ï¼Œè¿™åœ¨è‡ªå®šä¹‰adapteræ—¶éå¸¸æœ‰ç”¨ã€‚

å¯¹äºresponseå¯¹è±¡ï¼Œå¯ä»¥åœ¨adapter ä¸­ç»™å…¶æ·»åŠ ä»»ä½•è‡ªå®šä¹‰å±æ€§ï¼ˆä½†ä¸èƒ½æ˜¯æ·»åŠ keyä¸ºâ€œdataâ€çš„å­—æ®µ, å› ä¸ºåœ¨flyä¸­dataæ°¸è¿œä»£è¡¨è¯·æ±‚çš„æœ€ç»ˆç»“æœï¼ŒEngineWrapperä¸­ä¼šè‡ªåŠ¨è®¾ç½®ï¼‰ï¼Œç„¶åä¸Šå±‚åœ¨thenå›è°ƒä¸­å¯ä»¥å–å‡ºã€‚

### ä¸€ä¸ªç®€å•çš„ä¾‹å­

```javascript
var engine= EngineWrapper(function (request,responseCallback) {
            responseCallback({
                statusCode:200,
                responseText:"ä½ å˜æˆ–è€…ä¸å˜ï¼Œæˆ‘éƒ½ä¸å˜ğŸ˜œã€‚",
                extraFeild:"è‡ªå®šä¹‰å­—æ®µ"
            })
        })
fly.engine=engine;

fly.get("../package.json").then(d=>{
    log(d.data)
    log(d.extraFeild)
})

æ§åˆ¶å°è¾“å‡º

> ä½ å˜æˆ–è€…ä¸å˜ï¼Œæˆ‘éƒ½ä¸å˜ğŸ˜œã€‚
> è‡ªå®šä¹‰å­—æ®µ

```

è¿™ä¸ªä¾‹å­ä¸­ï¼Œadapter å¹¶æ²¡æœ‰çœŸæ­£å‘èµ· http è¯·æ±‚ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›äº†å›ºå®šå†…å®¹ï¼Œè¿™æ · fly ä¸Šå±‚è¯·æ±‚ä»»ä½•å€Ÿå£æ”¶åˆ°çš„å†…å®¹æ°¸è¿œéƒ½æ˜¯æŒ‡å®šçš„ responseText çš„å†…å®¹ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬çœ‹çœ‹çœŸæ­£å¼ºå¤§çš„ä½¿ç”¨å§¿åŠ¿ã€‚



## è¯·æ±‚é‡å®šå‘

 å¦‚æœä½ å¼€å‘çš„æ˜¯ä¸€ä¸ª PCæ¡Œé¢åº”ç”¨ã€æˆ–è€…ä¸€ä¸ªAPPï¼Œä½ éœ€è¦ä»¥é€šè¿‡å†…åµŒ h5 é¡µé¢çš„æ–¹å¼å®ç°éƒ¨åˆ†åŠŸèƒ½ï¼Œè¿™ç±»åº”ç”¨æˆ‘ä»¬ç»Ÿä¸€ç§°ä¹‹ä¸ºæ··åˆåº”ç”¨ã€‚ç„¶åä½ ä¼šå‘ç°ä½ **æ— æ³•å¹²æ¶‰ ** webview ä¸­ h5 é¡µé¢å‘èµ·çš„ ajax è¯·æ±‚ï¼Œæ— æ³•è¿›è¡Œç»Ÿä¸€çš„è¯·æ±‚ç®¡ç†ã€‚ä¸ºä»€ä¹ˆè¦è¿›è¡Œç»Ÿä¸€çš„è¯·æ±‚ç®¡ç†å‘¢ï¼Ÿä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§åœºæ™¯ï¼š

1. cookie åŒæ­¥.
2. æ¥å£å®‰å…¨
3. è®¿é—®æ§åˆ¶
4. æ€§èƒ½
5. ç¼“å­˜

### CookieåŒæ­¥

æ··åˆAPPç§éå¸¸å…³é”®çš„ä¸€ç‚¹å°±æ˜¯ Native å’Œ h5 ä¹‹é—´çš„ cookie åŒæ­¥ã€‚å› ä¸º Native å’Œ h5 éƒ½å¯ä»¥å‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œè€Œä¸¤è€…æ‰€ç”¨çš„è¯·æ±‚æ± å¹¶ä¸æ˜¯åŒä¸€ä¸ªï¼ˆh5Â  ajax è¯·æ±‚æ˜¯ webview å‘èµ·çš„ï¼‰ï¼Œè¿™å°±ä¼šå¯¼è‡´ NativeÂ å’Œ h5 cookie ä¸èƒ½åŒæ­¥ï¼Œå¦‚æœä¸èƒ½ç»Ÿä¸€ç®¡ç†è¯·æ±‚ï¼Œå°±ä¼šå¯¼è‡´ä½ è¦åœ¨ä¸åŒçš„åœºæ™¯åšå¤§é‡çš„åŒæ­¥å·¥ä½œã€‚æ›´æ²®ä¸§çš„æ˜¯ï¼Œåœ¨iosç³»ç»Ÿä¸­WKWebviewå¹¶æ²¡æœ‰æä¾› cookie åŒæ­¥çš„æ¥å£ï¼Œå¼€å‘è€…é€šå¸¸æ˜¯é€šè¿‡æ³¨å…¥ javascriptçš„æ–¹å¼é—´æ¥å®ç°ï¼Œä½†æ˜¯è¿™ç§åšæ³•æœ‰ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯æ— æ³•åŒæ­¥ httpOnly å±æ€§çš„ cookie , å› ä¸º javascript æ— æ³•æ“ä½œå…·æœ‰httpOnlyå±æ€§çš„cookie ( è¿™ä¸»è¦æ˜¯å› ä¸ºç°ä»£æµè§ˆå™¨ä¸ºäº†é˜²æ­¢xssæ”»å‡»æˆåŠŸåç¡®ä¿ç”¨æˆ·cookieä¸ä¼šè¢«æ¶æ„è„šæœ¬çªƒå–è€Œæ·»åŠ çš„ç‰¹æ€§ )ã€‚

### æ¥å£å®‰å…¨

ä¸ºäº†ç½‘ç»œä¼ è¾“æ•°æ®å®‰å…¨ï¼Œhttpsåè®®å·²ç»è¶Šæ¥è¶Šæ™®åŠï¼Œä½†æ˜¯ï¼Œæµè§ˆå™¨/webview å¯¹äºhttpsè¯·æ±‚ï¼Œé»˜è®¤çš„è¯ä¹¦æ ¡éªŒç­–ç•¥æ˜¯å…ˆæŸ¥çœ‹æœ¬åœ°ä¿¡ä»»è¯ä¹¦åˆ—è¡¨ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å»æ£€éªŒCAé“¾ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå¦‚æœæ”»å‡»è€…é€šè¿‡ä¼ªé€ çš„è¯ä¹¦å¼€ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œç„¶ååœ¨è‡ªå·±çš„æ‰‹æœºä¸­æ‰‹åŠ¨æ·»åŠ è¿™ä¸ªä¼ªé€ è¯ä¹¦è‡³æœ¬åœ°ä¿¡ä»»åˆ—è¡¨ï¼Œ ç„¶åæ”»å‡»è€…å°†æ‰‹æœºä»£ç†æŒ‡å‘å…¶ä»£ç†æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæ¥å£æ•°æ®å°†ä¼šå®Œå…¨æš´æ¼åœ¨æ”»å‡»è€…é¢å‰ã€‚è€Œç›®å‰é˜²æ­¢ä»£ç†æ–¹å¼æ”»å‡»æ–¹å¼å°±æ˜¯åœ¨ç«¯ä¸Šè¿›è¡Œè¯ä¹¦æ ¡éªŒï¼Œè¿™å¯ä»¥ä¿è¯Nativeå‘èµ·çš„è¯·æ±‚æ•°æ®æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯h5é€šè¿‡webviewå‘èµ·çš„è¯·æ±‚ä»å°†ä¼šæš´æ¼ï¼Œå¦‚æœä½ çš„APPæ˜¯ä¸€ä¸ªé‡‘èç†è´¢ç±»çš„åº”ç”¨ï¼Œè¿™å°†éå¸¸å±é™©ã€‚

### è®¿é—®æ§åˆ¶

ç”±äºæµè§ˆå™¨çš„**åŒæºç­–ç•¥**ï¼Œå¦‚æœh5è¯·æ±‚éœ€è¦**è·¨åŸŸ**ï¼Œæ˜¯ä¸€ä»¶æ¯”è¾ƒéº»çƒ¦çš„äº‹ã€‚ç°åœ¨çš„ä¸»æµçš„è·¨åŸŸæ–¹æ¡ˆï¼Œæ— è®ºæ˜¯jsonpï¼Œè¿˜æ˜¯é€šè¿‡è®¾ç½®**CORS**ï¼ˆCross Origin Resource Sharingï¼‰ç›¸å…³çš„è¯·æ±‚å¤´ï¼Œéƒ½éœ€è¦æœåŠ¡ç«¯æ”¯æŒã€‚ç„¶è€Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦èƒ½åœ¨ç«¯ä¸ŠæŒ‡å®šå“ªäº›åŸŸå¯ä»¥è®¿é—®ï¼Œå“ªäº›åŸŸä¸èƒ½è®¿é—®ï¼Œå¦‚æœè¯·æ±‚åœ¨webviewä¸­å‘èµ·ï¼Œç«¯ä¸Šæ ¹æœ¬æ— æ³•å¹²æ¶‰ã€‚

### æ€§èƒ½

ä¸åŒwebviewï¼Œåº•å±‚å¯¹ç½‘ç»œè¯·æ±‚å¤„ç†ç­–ç•¥å¾€å¾€ä¼šæœ‰ä¸åŒï¼Œæœ‰çš„æ˜¯é‡‡ç”¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œæœ‰çš„æ˜¯æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œè¿™å°±å¯¼è‡´åœ¨æœ‰äº›ç³»ç»Ÿä¸ŠåŸç”Ÿwebviewçš„è¯·æ±‚ä¼šç›¸å¯¹è¾ƒæ…¢ã€‚

### ç¼“å­˜

ç°åœ¨æœ‰äº›æ··åˆappä¸ºäº†å®ç°é¡µé¢ç§’å¼€ï¼Œéƒ½é‡‡ç”¨ä¸€äº›ç¼“å­˜è‡ªç®¡ç†çš„æ–¹æ¡ˆï¼Œå¸¸è§çš„å°±æ˜¯å°†çº¿ä¸Šæ–°ç‰ˆæœ¬çš„h5é¡µé¢æå‰æ‰“åŒ…ï¼Œç„¶ååœ¨æ²¡æ¬¡APPå¯åŠ¨åæ£€æµ‹æ›´æ–°ã€ä¸‹è½½ã€‚ç„¶åæ‹¦æˆª webview çš„æ‰€æœ‰è¯·æ±‚ï¼Œå¯¹äºé™æ€èµ„æºï¼Œç›´æ¥ä»ä¸‹è½½å¥½çš„æ–‡ä»¶ä¸­è¯»å–ï¼Œè€ŒåŠ¨æ€æ•°æ®åˆ™é€šè¿‡ajaxå»åå°åŠ¨æ€æ‹‰å»ï¼Œå¦‚æœåªæ˜¯è¿™æ ·ï¼Œé‚£å€’æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ï¼Œæœ‰æ—¶æœ‰äº›é™æ€èµ„æºä¹Ÿæ˜¯éœ€è¦é€šè¿‡ajaxå»æ‹‰å–ï¼Œæ¯”å¦‚ï¼Œä¸€ä¸ªé…ç½® jsonï¼Œ åˆæˆ–æ˜¯ä¸€ä¸ª mdæ ¼å¼çš„å¸®åŠ©æ–‡æ¡£ã€‚å¦‚æœä¸èƒ½æ‹¦æˆªajaxè¯·æ±‚ï¼Œä¹Ÿå°±æ„å‘³ç€è¿™äº›é™æ€èµ„æºè¿˜æ˜¯è¦é€šè¿‡ç½‘ç»œå»æœåŠ¡ç«¯æ‹‰å–ã€‚



ç»¼ä¸Šæ‰€å±ï¼Œå¦‚æœèƒ½åœ¨ç«¯ä¸Šè¿›è¡Œç»Ÿä¸€çš„è¯·æ±‚ç®¡ç†ï¼Œä¸Šé¢è¿™äº›é—®é¢˜å°†ä¼šå¼•åˆƒè€Œè§£ã€‚ä½†æ˜¯ï¼Œå¦‚ä½•å®ç°åœ¨ç«¯ä¸Šè¿›è¡Œç»Ÿä¸€çš„è¯·æ±‚ç®¡ç†ã€‚æˆ‘ä»¬è¯´è¿‡ï¼Œç›®å‰å¯¹äºå¤§å¤šæ•°å¹³å°çš„webviewï¼Œå®ƒä»¬å‘èµ·çš„ ajaxè¯·æ±‚ï¼Œnativeéƒ½æ˜¯æ— æ³•ç›´æ¥å¹²æ¶‰çš„ã€‚é‚£ä¹ˆç°åœ¨æœ‰äº†Flyï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ



## è¿œç¨‹Http Engine

æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œflyä½¿ç”¨çš„é»˜è®¤çš„engineå°±æ˜¯ XMLHttpRequestã€‚ å¦‚æœèƒ½åœ¨Nativeä¸Šå®ç°ä¸€ä¸ªengineï¼Œç„¶åä¾›æµè§ˆå™¨ä¸­çš„flyä½¿ç”¨ï¼Œé‚£ä¹ˆä¹Ÿå°±ä¼šå°†åŸæœ¬åº”è¯¥åœ¨æµè§ˆå™¨ä¸­å‘èµ·çš„è¯·æ±‚é‡å®šå‘åˆ°äº†Nativeä¸Šã€‚è€Œè¿™ä¸ªåœ¨Nativeä¸Šå®ç°çš„engineï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºä¸ºè¿œç¨‹engineï¼Œè¿™æ˜¯å› ä¸ºè°ƒç”¨è€…å’Œæ‰§è¡Œè€…å¹¶ä¸åœ¨åŒä¸€ä¸ªç¯å¢ƒã€‚æˆ‘ä»¬çœ‹çœ‹åœ¨flyä¸­å¦‚ä½•ä½¿ç”¨è¿œç¨‹engineã€‚åœ¨ä»‹ç»è¿™ä¸ªä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ **Javascript Bridge** ã€‚ 



> Javascript Bridge æ˜¯æŒ‡webåº”ç”¨ä¸­Javascriptä¸Nativeä¹‹é—´æ¥å£äº’è°ƒï¼Œæ•°æ®ä¼ è¾“çš„ä¸€ä¸ªæ¡¥æ¢ã€‚ç°åœ¨githubä¸­æœ‰ä¸€äº›æˆç†Ÿæ˜“ç”¨çš„ç§»åŠ¨ç«¯è·¨å¹³å°å®ç°å¦‚: [dsBridge](https://github.com/wendux/DSBridge-Android) ã€ [WebViewJavascriptBridge](https://github.com/marcuswestin/WebViewJavascriptBridge) ã€‚

è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨adapterÂ å°†è¯·æ±‚é€šè¿‡ javascript bridge è½¬å‘åˆ° Natvieä¸Šï¼Œç„¶ååœ¨native ä¸Šè¿›è¡Œç»Ÿä¸€çš„ç½‘ç»œè¯·æ±‚ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨nativeè¿›è¡Œç»Ÿä¸€çš„è¯ä¹¦éªŒè¯ã€cookieç®¡ç†ã€è®¿é—®æ§åˆ¶ è¿˜æœ‰ç¼“å­˜ç­–ç•¥ã€‚ç­‰åˆ°nativeè¯·æ±‚å®Œæˆåå†å°†è¯·æ±‚ç»“æœä¼ é€’ç»™adapterã€‚ ç„¶åadapterå†ä¼ é€’ç»™flyã€‚ç°åœ¨é—®é¢˜ç®€åŒ–ä¸ºï¼Œåªéœ€ä¸ºä¸åŒçš„ javascript bridgeæä¾›ä¸€ä¸ªadapterå³å¯ã€‚ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œflyé¢„ç½®äº†DSBridgeçš„é€‚é…å™¨ ã€‚

### Nativeå®ç°

flyå°†httpè¯·æ±‚é‡å®šå‘åˆ°Nativeæ—¶ï¼ŒNativeéœ€è¦å®ç°çœŸæ­£çš„httpè¯·æ±‚ã€‚å…·ä½“å®ç°ç”±ç«¯ä¸Šæ ¹æ®ä½¿ç”¨çš„ç½‘ç»œæ¡†æ¶è‡ªå®šã€‚Flyå®˜æ–¹æä¾›äº†Androidç«¯çš„å®ç°ç¤ºä¾‹ï¼Œå¯ä¾›å¼€å‘è€…å‚è€ƒã€‚

### DSBridge Adapter

[dsBridge](https://github.com/wendux/DSBridge-Android)  æ˜¯ä¸€ä¸ªä¼˜ç§€çš„è·¨å¹³å°çš„ Javascript Bridge ï¼Œæœ€å¤§çš„ç‰¹ç‚¹æ˜¯ä¸ä»…æ”¯æŒ**å¼‚æ­¥è°ƒç”¨**ï¼Œä¹Ÿæ”¯æŒ**å¼‚æ­¥è°ƒç”¨**å’Œè¿›åº¦**è¿ç»­è°ƒç”¨**ã€‚å¦‚æœä½ çš„ App ä½¿ç”¨çš„æ˜¯DSBridgeï¼Œ é‚£ä¹ˆä½ å¯ä»¥éå¸¸æ–¹ä¾¿çš„ä½¿ç”¨flyã€‚

```javascript
var adapter = require("flyio/dist/adapter/dsbridge")
var EngineWrapper = require("flyio/dist/engine-wrapper")
var Fly = require("flyio/dist/fly")

var dsEngine = EngineWrapper(adapter)
var fly = new Fly(engine);
//ç„¶åä½ å°±å¯ä»¥ä½¿ç”¨flyå‘èµ·è¯·æ±‚äº†
fly.get("xxx.com")...
```



ç°åœ¨åœ¨h5ä¸­é€šè¿‡flyå‘èµ·çš„æ‰€æœ‰ajaxè¯·æ±‚éƒ½ä¼šè¢«é‡å®šå‘åˆ°ç«¯ä¸Šï¼Œä¸‹ä¸€èŠ‚æˆ‘ä»¬çœ‹çœ‹Nativeç«¯æ”¹å¦‚ä½•å®ç°ã€‚

